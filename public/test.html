<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>FMGO</title> 
    <link rel="stylesheet" href="styles/game.css">  

<div style='position:absolute;z-index:0;left:0;top:0;width:100%;height:100%'>
        <img src='https://freedomguidedogs.org/wp-content/uploads/2017/09/grey-dark-vintage-background-texture.jpg' style='width:100%;height:100%' alt='[]' />
    </div>
  
  <div style='position:absolute;z-index:0;left:0;top:0;width:100%;height:100%'>
        <img src='https://www.noupe.com/wp-content/uploads/2012/06/ultimatetexturecollection20.jpg' style='width:50%;height:50%' alt='[]' />
    </div>
  
    <div style='position:absolute;z-index:1;left:15%;top:15%;width:100%;height:100%'>
            <img src='https://i1.wp.com/www.bmcrumc.org/wp-content/uploads/2017/07/white-background-2.jpg' style='width:70%;height:70%' alt='[]' />
    </div>
  
<!--   Deleted code!! -->
<!--     <div style='position:absolute;z-index:2;left:37.5%;top:30%;width:100%;height:100%'>
            <img src='https://www.hareandhoundsbath.com/wp-content/themes/hare-and-hounds/images/hare-and-hounds-bath-logo.png' style='width:25%' alt='[]' />
   

</div> -->
<!--  <button class="button open-button" id="open-button">Start Game</button> -->

<!--  New code!! -->
  <svg viewBox="0 0 800 400" width="800" height="400">
    <circle cx="250" cy="200" r="195" fill="#0B0C10" opacity="1"/>
    <circle cx="550" cy="200" r="195" fill="#0B0C10" opacity="1"/>
    <rect width="300" height="390" x="250" y="5" fill="#0B0C10"/>
  
    <polygon points="250,50 100,200 250,350" stroke-width=3 stroke="#C5C6C7" fill="#1F2833"/>
    <rect width="300" height="300" x="250" y="50" stroke-width=3 stroke="#C5C6C7" fill="#1F2833"/>
    <line x1="250" y1="50" x2="550" y2="350" stroke-width=3 stroke="#C5C6C7"/>
    <line x1="550" y1="50" x2="250" y2="350" stroke-width=3 stroke="#C5C6C7"/>
    <line x1="400" y1="50" x2="400" y2="350" stroke-width=3 stroke="#C5C6C7"/>
    <line x1="100" y1="200" x2="700" y2="200" stroke-width=3 stroke="#C5C6C7"/>
    <polygon points="550,50 700,200 550,350" stroke-width=3 stroke="#C5C6C7" fill="#1F2833" />
    
    <circle class="node" id="t2" cx="250" cy="50" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="t3" cx="400" cy="50" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="t4" cx="550" cy="50" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="m1" cx="100" cy="200" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="m2" cx="250" cy="200" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="m3" cx="400" cy="200" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="m4" cx="550" cy="200" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="m5" cx="700" cy="200" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="b2" cx="250" cy="350" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="b3" cx="400" cy="350" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
    <circle class="node" id="b4" cx="550" cy="350" r="20" stroke="black" stroke-width="1" fill="red" opacity="0"/>
  
    <circle class="piece" id="1" cx="250" cy="50" r="25" stroke="black" stroke-width="3" fill="#45A29E" opacity="1" space="t2"/>
    <circle class="piece" id="2" cx="100" cy="200" r="25" stroke="black" stroke-width="3" fill="#45A29E" opacity="1"/>
    <circle class="piece" id="3" cx="250" cy="350" r="25" stroke="black" stroke-width="3" fill="#45A29E" opacity="1"/>
    <circle class="piece" id="4" cx="400" cy="200" r="28" stroke="black" stroke-width="3" fill="#66FCF1" opacity="1"/>
</svg>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="assets/javascript/app.js"></script>
<script>
    // $(document).on("click", ".blackpiece", func)
    // var pieces = [];    
    // console.log(pieces);

    function getPieces() {
        $.get("/api/gameStart", function(data) {
            console.log(data);
            var pieces = [];
            for (var i = 0; i < data.length; i++) {                
                console.log(data[i].id);
                id = data[i].id;

                console.log(data[i].cx);
                currcx = data[i].cx;

                console.log(data[i].cy);
                currcy = data[i].cy;
                
                $("#"+id).attr({cx: currcx, cy: currcy});
            }
        });
    }
    getPieces();

    
    
        
    // $(document).on("click", ".node", movePieceOne);
    // function movePieceOne(event) {
    //     event.stopPropagation();
    //     var newX = $(this).attr("cx"); 
    //     var newY = $(this).attr("cy"); 
    //     console.log(newX, newY); 
    //     $("#1").attr({cx: newX, cy: newY});       
    // }


$("#1").on("click", function(event) {
    event.stopPropagation();
    var id = $(this).attr("id");
  $(".node").on("click", function(event) {
    let newX = $(this).attr("cx");
    let newY = $(this).attr("cy");
    $("#1").attr({cx: newX, cy: newY});
    $.ajax({
            method: "PUT",
            url: "/api/piece/" + id,
            data: {
                cy: newY,
                cx: newX 
            }
        }).then(getPieces);
  });
});

$("#2").on("click", function(event) {
    event.stopPropagation();
    var id = $(this).attr("id");
    $(".node").on("click", function() {
        
        let newX = $(this).attr("cx");
        let newY = $(this).attr("cy");
        $("#2").attr({cx: newX, cy: newY});
        
        console.log(newX, newY);
        console.log(id);
        $.ajax({
            method: "PUT",
            url: "/api/piece/" + id,
            data: {
                cy: newY,
                cx: newX 
            }
        }).then(getPieces);
  });
});

$("#3").on("click", function() {
    event.stopPropagation();
    var id = $(this).attr("id");
  $(".node").on("click", function() {
    
    let newX = $(this).attr("cx");
    let newY = $(this).attr("cy");

    $("#3").attr({cx: newX, cy: newY});
    $.ajax({
        method: "PUT",
        url: "/api/piece/" + id,
        data: {
            cy: newY,
            cx: newX 
        }
    }).then(getPieces);
  });
});

// New code!!
$("#4").on("click", function() {
    event.stopPropagation();
    var id = $(this).attr("id");
  $(".node").on("click", function() {
    
    let newX = $(this).attr("cx");
    let newY = $(this).attr("cy");

    $("#4").attr({cx: newX, cy: newY});
    $.ajax({
        method: "PUT",
        url: "/api/piece/" + id,
        data: {
            cy: newY,
            cx: newX 
        }
    }).then(getPieces);
  });
});

// getPieces();

</script>

</body>

</html>